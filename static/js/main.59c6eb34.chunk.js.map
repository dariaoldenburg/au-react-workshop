{"version":3,"sources":["ui/Cell.tsx","ChatAPI.ts","ui/Row.tsx","UsersList.tsx","MessagesListThread.tsx","MessagesList.tsx","ui/Button.tsx","MessageBox.tsx","Chat.tsx","App.tsx","index.tsx"],"names":["Cell","props","react_default","a","createElement","className","classNames","Object","defineProperty","Cell--header","header","Cell--padded","padded","Cell--scrollable","scrollable","concat","textAlign","style","width","widthPercentage","height","children","defaultProps","uuid","currentUser","undefined","users","users$","ReplaySubject","messages","messages$","_setUsers","_users","next","_setMessages","_messages","_addMessage","message","nextMessages","toConsumableArray","parentMessage","parentMessageId","find","m","id","index","indexOf","objectSpread","submessages","content","createdAt","Date","toString","user","push","login","Promise","resolve","reject","setTimeout","_addUser","name","logout","filter","u","color","senior","Row","UsersList","map","key","fontWeight","SubmessagesList","_ref","extended","onClick","marginLeft","MessagesListThread_MessagesListThread","length","MessagesListThread","_React$PureComponent","_getPrototypeOf2","_this","classCallCheck","this","_len","arguments","args","Array","_key","possibleConstructorReturn","getPrototypeOf","call","apply","state","handleShowMore","setState","inherits","createClass","value","_this$props","onReplyClick","showSubmessages","date","cursor","toLocaleTimeString","MessagesListThread_SubmessagesList","React","PureComponent","MessagesList","Fragment","Button","_classNames","variant","disabled","type","fullWidth","MessageBox","onChange","onSubmit","replyTo","onReplyClear","event","preventDefault","handleSubmit","background","margin","padding","target","handleChange","Button_Button","Chat","channelName","onlineUsers","onlineUsersLoading","messagesLoading","currentMessage","_subscriptions","handleSendMessage","handleTextAreaOnChange","handleSignIn","prompt","then","alert","handleSignOut","handleReplyClick","handleReplyClear","_this2","asObservable","subscribe","forEach","s","unsubscribe","_this$state","Row_Row","Cell_Cell","UsersList_UsersList","MessageBox_MessageBox","App","Chat_Chat","ReactDOM","render","src_App","document","getElementById"],"mappings":"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","file":"static/js/main.59c6eb34.chunk.js","sourcesContent":["import React from 'react';\nimport classNames from 'classnames';\nimport './Cell.css';\n\ninterface CellProps {\n  header: boolean;\n  padded: boolean;\n  scrollable?: boolean;\n  textAlign: 'left' | 'center' | 'right';\n  widthPercentage: number;\n  height?: number;\n  children?: React.ReactNode;\n}\n\nexport function Cell(props: CellProps) {\n  return (\n    <div\n      className={classNames('Cell', {\n        'Cell--header': props.header,\n        'Cell--padded': props.padded,\n        'Cell--scrollable': props.scrollable,\n        [`Cell--textAlign-${props.textAlign}`]: props.textAlign\n      })}\n      style={{\n        width: `${props.widthPercentage}%`,\n        height: props.height\n      }}\n    >\n      {props.children}\n    </div>\n  );\n}\n\nCell.defaultProps = {\n  header: false,\n  padded: true,\n  scrollable: false,\n  textAlign: 'left'\n};\n","import { ReplaySubject } from 'rxjs';\n\nexport interface User {\n  id: number;\n  name: string;\n  color?: string;\n  senior?: boolean;\n}\n\nexport interface Message {\n  id: number;\n  createdAt: string;\n  content: string;\n  user?: User;\n  submessages?: Message[];\n}\n\nlet uuid = 100;\nlet currentUser: User | undefined = undefined;\n\nlet users: User[] = [];\nconst users$ = new ReplaySubject<User[]>(1);\nlet messages: Message[] = [];\nconst messages$ = new ReplaySubject<Message[]>(1);\n\nfunction _setUsers(_users: User[]) {\n  users = _users;\n  users$.next(_users);\n}\n\nfunction _setMessages(_messages: Message[]) {\n  messages = _messages;\n  messages$.next(_messages);\n}\n\nfunction _addMessage(message: { content: string; parentMessageId?: number }) {\n  const nextMessages = [...messages];\n  const parentMessage = message.parentMessageId\n    ? nextMessages.find(m => m.id === message.parentMessageId)\n    : undefined;\n\n  if (parentMessage) {\n    const index = nextMessages.indexOf(parentMessage);\n    nextMessages[index] = {\n      ...parentMessage,\n      submessages: [\n        ...(parentMessage.submessages || []),\n        {\n          id: ++uuid,\n          content: message.content,\n          createdAt: new Date().toString(),\n          user: currentUser\n        }\n      ]\n    };\n  } else {\n    nextMessages.push({\n      id: ++uuid,\n      content: message.content,\n      createdAt: new Date().toString(),\n      user: currentUser,\n      submessages: []\n    });\n  }\n\n  _setMessages(nextMessages);\n}\n\nfunction _addUser(user: User) {\n  _setUsers([...users, user]);\n}\n\nfunction _removeUser(user: User) {\n  _setUsers(users.filter(u => u.id !== user.id));\n}\n\nfunction _init() {\n  setTimeout(() => {\n    _setUsers([\n      { id: ++uuid, name: 'geron' },\n      { id: ++uuid, name: 'hit_fm', color: 'pink', senior: true },\n      { id: ++uuid, name: 'kasienka2' },\n      { id: ++uuid, name: 'Lady_Ann_' },\n      { id: ++uuid, name: 'MalWINKaaa', color: 'orange', senior: true }\n    ]);\n\n    _setMessages([\n      {\n        id: ++uuid,\n        createdAt: new Date().toString(),\n        content: '@here ślimak',\n        user: users[1],\n        submessages: []\n      },\n      {\n        id: ++uuid,\n        createdAt: new Date().toString(),\n        content: 'mingwok ktoś?',\n        user: users[4],\n        submessages: [\n          {\n            id: ++uuid,\n            createdAt: new Date().toString(),\n            content: ':+1:',\n            user: users[2]\n          },\n          {\n            id: ++uuid,\n            createdAt: new Date().toString(),\n            content: '1x makaron smażony z kurczakiem',\n            user: users[3]\n          },\n          {\n            id: ++uuid,\n            createdAt: new Date().toString(),\n            content: '@kasienka2 a jaki makaron?',\n            user: users[4]\n          }\n        ]\n      }\n    ]);\n  }, 1000);\n}\n\n_init();\n\nexport function fetchMessages() {\n  return messages$.asObservable();\n}\n\nexport function fetchOnlineUsers() {\n  return users$.asObservable();\n}\n\nexport function createMessage(message: {\n  content: string;\n  parentMessageId?: number;\n}) {\n  return new Promise((resolve, reject) => {\n    setTimeout(() => {\n      _addMessage(message);\n      resolve();\n    }, 500);\n  });\n}\n\nexport function login(user: {\n  name: string;\n  color?: string;\n  senior?: boolean;\n}) {\n  return new Promise<User>((resolve, reject) => {\n    setTimeout(() => {\n      currentUser = { id: ++uuid, ...user };\n\n      _addUser(currentUser);\n      _addMessage({\n        content: `** przychodzi ${currentUser.name}...`\n      });\n\n      resolve(currentUser);\n    }, 500);\n  });\n}\n\nexport function logout() {\n  if (!currentUser) {\n    return Promise.resolve();\n  }\n\n  return new Promise((resolve, reject) => {\n    setTimeout(() => {\n      if (currentUser) {\n        _removeUser(currentUser);\n        _addMessage({\n          content: `** odchodzi ${currentUser.name}...`\n        });\n      }\n      resolve();\n    }, 500);\n  });\n}\n","import React from 'react';\nimport './Row.css';\n\ninterface RowProps {\n  children?: React.ReactNode;\n}\n\nexport function Row(props: { children?: React.ReactNode }) {\n  return <div className=\"Row\">{props.children}</div>;\n}\n","import React from 'react';\nimport { User } from './ChatAPI';\nimport './UsersList.css';\n\ninterface UsersListProps {\n  users: User[];\n}\n\nexport function UsersList(props: UsersListProps) {\n  return (\n    <div className=\"UsersList\">\n      {props.users.map(user => (\n        <div\n          key={user.id || user.name}\n          className=\"UsersList__item\"\n          style={{\n            color: user.color || 'black',\n            fontWeight: user.senior ? 'bold' : undefined\n          }}\n        >\n          {user.name}\n        </div>\n      ))}\n    </div>\n  );\n}\n","import React from 'react';\nimport { Message } from './ChatAPI';\n\nconst SubmessagesList = ({\n  messages,\n  extended,\n  onClick\n}: {\n  messages: Message[];\n  extended: boolean;\n  onClick(): void;\n}) => {\n  return (\n    <div style={{ marginLeft: 20 }}>\n      {extended &&\n        messages.map(message => (\n          <MessagesListThread key={message.id} message={message} />\n        ))}\n      <div>\n        <button onClick={onClick}>\n          {!extended\n            ? `[pokaż odpowiedzi (${messages.length})]`\n            : '[schowaj odpowiedzi]'}\n        </button>\n      </div>\n    </div>\n  );\n};\n\ninterface MessagesListThreadProps {\n  message: Message;\n  showSubmessages: boolean;\n  onReplyClick?(): void;\n}\n\ninterface MessagesListThreadState {\n  extended: boolean;\n}\n\nexport class MessagesListThread extends React.PureComponent<\n  MessagesListThreadProps,\n  MessagesListThreadState\n> {\n  static defaultProps = {\n    showSubmessages: true\n  };\n\n  state = {\n    extended: false\n  };\n\n  handleShowMore = () => {\n    this.setState(state => ({\n      extended: !state.extended\n    }));\n  };\n\n  render() {\n    const { message, onReplyClick, showSubmessages } = this.props;\n    const { extended } = this.state;\n    const date = new Date(message.createdAt);\n\n    return (\n      <div key={message.id || message.content}>\n        <strong\n          onClick={onReplyClick}\n          style={{\n            cursor: 'pointer'\n          }}\n        >\n          [{date.toLocaleTimeString()}]\n        </strong>{' '}\n        {message.user && (\n          <span\n            style={{\n              color: message.user.color,\n              fontWeight: message.user.senior ? 'bold' : undefined\n            }}\n          >\n            {message.user.name}:{' '}\n          </span>\n        )}\n        {message.content}\n        {showSubmessages &&\n          message.submessages &&\n          message.submessages.length > 0 && (\n            <SubmessagesList\n              messages={message.submessages}\n              extended={extended}\n              onClick={this.handleShowMore}\n            />\n          )}\n      </div>\n    );\n  }\n}\n","import React from 'react';\nimport { MessagesListThread } from './MessagesListThread';\nimport { Message } from './ChatAPI';\n\ninterface MessagesListProps {\n  messages: Message[];\n  onReplyClick?(message: Message): void;\n}\n\nexport function MessagesList(props: MessagesListProps) {\n  return (\n    <React.Fragment>\n      {props.messages.map(message => (\n        <MessagesListThread\n          key={message.id}\n          message={message}\n          onReplyClick={() => props.onReplyClick && props.onReplyClick(message)}\n        />\n      ))}\n    </React.Fragment>\n  );\n}\n","import React from 'react';\nimport classNames from 'classnames';\nimport './Button.css';\n\ninterface ButtonProps {\n  variant: 'primary' | 'secondary';\n  type?: 'submit' | 'button' | 'reset';\n  disabled?: boolean;\n  onClick?: () => void;\n  children?: React.ReactNode;\n  fullWidth?: boolean;\n}\n\nexport function Button(props: ButtonProps) {\n  const { children, onClick, variant, disabled, type, fullWidth } = props;\n\n  return (\n    <button\n      className={classNames('Button', {\n        [`Button--variant--${variant}`]: true,\n        [`Button--fullWidth`]: fullWidth\n      })}\n      onClick={onClick}\n      disabled={disabled}\n      type={type}\n    >\n      {children}\n    </button>\n  );\n}\n\nButton.defaultProps = {\n  variant: 'primary'\n};\n","import React from 'react';\nimport { Button } from './ui/Button';\nimport './MessageBox.css';\nimport { Message } from './ChatAPI';\nimport { MessagesListThread } from './MessagesListThread';\n\nexport interface MessageBox {\n  message: string;\n  disabled?: boolean;\n  replyTo?: Message;\n  onReplyClear?(): void;\n  onChange: (value: string) => void;\n  onSubmit: () => void;\n}\n\nfunction handleChange(\n  event: React.ChangeEvent<HTMLTextAreaElement>,\n  onChange: MessageBox['onChange']\n) {\n  if (onChange) {\n    onChange(event.target.value);\n  }\n}\n\nfunction handleSubmit(\n  event: React.FormEvent<HTMLFormElement>,\n  onSubmit: MessageBox['onSubmit']\n) {\n  event.preventDefault();\n  if (onSubmit) {\n    onSubmit();\n  }\n}\n\nexport function MessageBox(props: MessageBox) {\n  const {\n    onChange,\n    onSubmit,\n    message,\n    disabled,\n    replyTo,\n    onReplyClear\n  } = props;\n\n  return (\n    <form\n      onSubmit={event => handleSubmit(event, onSubmit)}\n      className=\"MessageBox\"\n    >\n      {replyTo && (\n        <div>\n          Odpowiadasz na{' '}\n          <button type=\"button\" onClick={onReplyClear}>\n            (anuluj)\n          </button>\n          <div\n            style={{\n              background: '#fff',\n              margin: '5px 0',\n              padding: '5px'\n            }}\n          >\n            <MessagesListThread message={replyTo} showSubmessages={false} />\n          </div>\n        </div>\n      )}\n\n      <textarea\n        value={message}\n        onChange={event => handleChange(event, onChange)}\n        className=\"MessageBox__textarea\"\n        disabled={disabled}\n      />\n\n      <Button type=\"submit\" disabled={disabled}>\n        Wyślij\n      </Button>\n    </form>\n  );\n}\n","import React from 'react';\nimport { Subscription } from 'rxjs';\nimport { Cell } from './ui/Cell';\nimport {\n  fetchOnlineUsers,\n  User,\n  fetchMessages,\n  Message,\n  createMessage,\n  login,\n  logout\n} from './ChatAPI';\nimport { Row } from './ui/Row';\nimport { UsersList } from './UsersList';\nimport { MessagesList } from './MessagesList';\nimport { MessageBox } from './MessageBox';\nimport { Button } from './ui/Button';\n\ninterface ChatState {\n  channelName: string;\n  currentUser: User | null;\n  onlineUsers: User[];\n  onlineUsersLoading: boolean;\n  messages: Message[];\n  messagesLoading: boolean;\n  currentMessage: string;\n  replyTo?: Message;\n}\n\nexport class Chat extends React.PureComponent<{}, ChatState> {\n  state = {\n    channelName: 'AppUnite: #obiady',\n    currentUser: null,\n    onlineUsers: [],\n    onlineUsersLoading: true,\n    messages: [],\n    messagesLoading: true,\n    currentMessage: '',\n    replyTo: undefined\n  };\n\n  private _subscriptions: Subscription[] = [];\n\n  componentDidMount() {\n    this._subscriptions.push(\n      fetchOnlineUsers().subscribe(users => {\n        this.setState({\n          onlineUsers: users,\n          onlineUsersLoading: false\n        });\n      })\n    );\n\n    this._subscriptions.push(\n      fetchMessages().subscribe(messages => {\n        this.setState({\n          messages,\n          messagesLoading: false\n        });\n      })\n    );\n  }\n\n  componentWillUnmount() {\n    this._subscriptions.forEach(s => s.unsubscribe());\n    this._subscriptions.length = 0;\n  }\n\n  handleSendMessage = () => {\n    const { currentMessage } = this.state;\n\n    createMessage({ content: currentMessage });\n    this.setState({\n      currentMessage: '',\n      replyTo: undefined\n    });\n  };\n\n  handleTextAreaOnChange = (value: string) => {\n    this.setState({\n      currentMessage: value\n    });\n  };\n\n  handleSignIn = () => {\n    const name = prompt('Twój nick: ', 'gość123');\n    const color = prompt('Kolor: ', 'red') || undefined;\n\n    if (name) {\n      return login({ name, color }).then(currentUser => {\n        this.setState({ currentUser });\n      });\n    }\n    alert('Podaj nick!');\n  };\n\n  handleSignOut = () => {\n    logout();\n    this.setState({ currentUser: null });\n  };\n\n  handleReplyClick = (message: Message) => {\n    this.setState({\n      replyTo: message\n    });\n  };\n\n  handleReplyClear = () => {\n    this.setState({\n      replyTo: undefined\n    });\n  };\n\n  render() {\n    const {\n      channelName,\n      onlineUsers,\n      onlineUsersLoading,\n      messages,\n      messagesLoading,\n      currentMessage,\n      currentUser,\n      replyTo\n    } = this.state;\n\n    return (\n      <div className=\"Chat\">\n        <Row>\n          <Cell header widthPercentage={70}>\n            <strong>{channelName}</strong>\n          </Cell>\n          <Cell header widthPercentage={30} textAlign=\"center\">\n            Obecni: [{onlineUsersLoading ? '...' : onlineUsers.length}]\n          </Cell>\n        </Row>\n\n        <Row>\n          <Cell widthPercentage={70} scrollable height={300}>\n            {messagesLoading ? (\n              <div>Ładowanie...</div>\n            ) : (\n              <MessagesList\n                messages={messages}\n                onReplyClick={this.handleReplyClick}\n              />\n            )}\n          </Cell>\n          <Cell widthPercentage={30} scrollable height={300}>\n            <UsersList users={onlineUsers} />\n          </Cell>\n        </Row>\n\n        <Row>\n          <Cell header widthPercentage={70}>\n            <MessageBox\n              message={currentMessage}\n              disabled={!currentUser}\n              replyTo={replyTo}\n              onReplyClear={this.handleReplyClear}\n              onChange={this.handleTextAreaOnChange}\n              onSubmit={this.handleSendMessage}\n            />\n          </Cell>\n          <Cell widthPercentage={30}>\n            {currentUser ? (\n              <Button\n                onClick={this.handleSignOut}\n                variant=\"secondary\"\n                fullWidth\n              >\n                Wyloguj się\n              </Button>\n            ) : (\n              <Button onClick={this.handleSignIn} variant=\"secondary\" fullWidth>\n                Zaloguj się\n              </Button>\n            )}\n          </Cell>\n        </Row>\n      </div>\n    );\n  }\n}\n","import React from 'react';\nimport './App.css';\nimport { Chat } from './Chat';\n\nfunction App() {\n  return (\n    <div className=\"App\">\n      <Chat />\n    </div>\n  );\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n\nReactDOM.render(<App />, document.getElementById('root'));\n"],"sourceRoot":""}